{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<h2 class="mb-4">Latest Posts</h2>

{% for post in posts %}
<div class="card mb-3">
  <!-- Shows Images -->
  <div class="card mb-4">
    {% if post.featured_image %}
        <img src="{{ post.featured_image.url }}" class="card-img-top" style="height: 250px; object-fit: cover;">
    {% else %}
        <img src="/static/images/placeholder.jpg" class="card-img-top" style="height: 250px; object-fit: cover;">
    {% endif %}

    <div class="card-body">

        <!-- Post title -->
        <h4>
            <a href="{% url 'blog:post-detail' post.slug %}">{{ post.title }}</a>
        </h4>

        <!-- Category -->
        {% if post.category %}
        <p class="text-muted mb-1">
            In 
            <a href="{% url 'blog:category-posts' post.category.slug %}">
                {{ post.category.name }}
            </a>
        </p>
        {% endif %}

        <!-- Tags -->
        {% if post.tags.all %}
            {% for tag in post.tags.all %}
            <a href="{% url 'blog:tag-posts' tag.slug %}" 
               class="badge bg-light text-dark me-1">
                {{ tag.name }}
            </a>
            {% endfor %}
        {% endif %}

        <!-- Meta details -->
        <p class="text-muted mt-2">
            {{ post.created_at|date:"d M Y" }} ‚Äî by {{ post.author.username }}
        </p>
        <!-- Views Count -->
         <p class="text-muted">
          üëÅÔ∏è {{ post.views }} views
        </p>

        <!-- Content preview -->
        <p>{{ post.content|truncatewords:25|safe }}</p>

        <!-- Read more -->
        <a href="{% url 'blog:post-detail' post.slug %}" 
           class="btn btn-primary btn-sm">
            Read More
        </a>

    </div>
</div>
{% empty %}
<p>No posts yet.</p>
{% endfor %}

<!-- Pagination -->
<nav aria-label="Page navigation">
    <ul class="pagination">

        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a>
        </li>
        {% endif %}

        <li class="page-item active">
            <span class="page-link">
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            </span>
        </li>

        {% if page_obj.has_next %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
        </li>
        {% endif %}

    </ul>
</nav>

{% endblock %}
